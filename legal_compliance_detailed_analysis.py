#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ³•çš„ãƒ»æ¥­ç•Œæ¨™æº–æº–æ‹ ã®å…·ä½“çš„é›†è¨ˆå†…å®¹è©³ç´°åˆ†æ
å„é›†è¨ˆé …ç›®ãŒå¯¾å¿œã™ã‚‹æ³•ä»¤æ¡æ–‡ã¨æ¥­ç•Œæ¨™æº–ã®æ˜ç¢ºåŒ–
"""

from pathlib import Path

def analyze_legal_compliance_calculations():
    """æ³•çš„æº–æ‹ ã®ãŸã‚ã®å…·ä½“çš„é›†è¨ˆå†…å®¹åˆ†æ"""
    
    print("=" * 100)
    print("ğŸ“‹ æ³•çš„ãƒ»æ¥­ç•Œæ¨™æº–æº–æ‹ ã®å…·ä½“çš„é›†è¨ˆå†…å®¹è©³ç´°åˆ†æ")
    print("=" * 100)
    
    # 1. åŠ´åƒåŸºæº–æ³•æº–æ‹ ã®é›†è¨ˆé …ç›®
    print("\nğŸ›ï¸ åŠ´åƒåŸºæº–æ³•æº–æ‹ é›†è¨ˆ")
    print("-" * 90)
    
    labor_law_calculations = {
        "åŠ´åƒåŸºæº–æ³•ç¬¬32æ¡ï¼ˆåŠ´åƒæ™‚é–“ï¼‰": {
            "é›†è¨ˆé …ç›®": "monthly_hours = group.groupby('year_month')['parsed_slots_count'].sum() * SLOT_HOURS",
            "å…·ä½“çš„å‡¦ç†": [
                "1. å€‹äººåˆ¥ãƒ»æœˆåˆ¥ã®ç·åŠ´åƒæ™‚é–“ã‚’é›†è¨ˆ",
                "2. æœˆé–“åŠ´åƒæ™‚é–“ = ã‚¹ãƒ­ãƒƒãƒˆæ•° Ã— 0.5æ™‚é–“",
                "3. å…¨ä½“å¹³å‡ã®1.5å€è¶…éã‚’ç•°å¸¸ã¨ã—ã¦æ¤œçŸ¥",
                "4. threshold = overall_mean * 1.5"
            ],
            "æ³•çš„åŸºæº–": "æœˆé–“160æ™‚é–“ï¼ˆä¸€èˆ¬ï¼‰ã€æœˆé–“240æ™‚é–“ï¼ˆåŒ»ç™‚å¾“äº‹è€…ä¸Šé™ï¼‰",
            "é‡è¦åº¦åˆ¤å®š": "ç·Šæ€¥ï¼ˆ2å€è¶…éï¼‰ã€é«˜ï¼ˆ1.5å€è¶…éï¼‰ã€ä¸­ï¼ˆ1.2å€è¶…éï¼‰",
            "å‡ºåŠ›ä¾‹": "2024-07æœˆã®åŠ´åƒæ™‚é–“ãŒç•°å¸¸ã«å¤šã„ (280.5æ™‚é–“)"
        },
        
        "åŠ´åƒåŸºæº–æ³•ç¬¬35æ¡ï¼ˆä¼‘æ—¥ï¼‰": {
            "é›†è¨ˆé …ç›®": "continuous_days = é€£ç¶šå‹¤å‹™æ—¥æ•°ã®è¨ˆç®—",
            "å…·ä½“çš„å‡¦ç†": [
                "1. work_dates = group['ds'].dt.date.unique().sort()",
                "2. æ—¥ä»˜å·®ãŒ1æ—¥ã®å ´åˆã€é€£ç¶šå‹¤å‹™ã¨ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆ",
                "3. continuous_days > 7æ—¥ã§é•åã¨ã—ã¦æ¤œçŸ¥",
                "4. æœŸé–“é–‹å§‹æ—¥ã€œçµ‚äº†æ—¥ã‚’è¨˜éŒ²"
            ],
            "æ³•çš„åŸºæº–": "é€±1å›ã®ä¼‘æ—¥ç¢ºä¿ï¼ˆé€£ç¶š7æ—¥å‹¤å‹™ã¯åŸå‰‡é•åï¼‰",
            "é‡è¦åº¦åˆ¤å®š": "ç·Šæ€¥ï¼ˆ12æ—¥è¶…éï¼‰ã€é«˜ï¼ˆ7æ—¥è¶…éï¼‰ã€ä¸­ï¼ˆ5æ—¥è¶…éï¼‰",
            "å‡ºåŠ›ä¾‹": "10æ—¥é–“ã®é€£ç¶šå‹¤å‹™ã‚’æ¤œå‡º (2024-07-01 â†’ 2024-07-10)"
        },
        
        "åŠ´åƒæ™‚é–“ç­‰è¨­å®šæ”¹å–„æ³•ï¼ˆå‹¤å‹™é–“ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ï¼‰": {
            "é›†è¨ˆé …ç›®": "interval_hours = (curr_start - prev_end).total_seconds() / 3600",
            "å…·ä½“çš„å‡¦ç†": [
                "1. sorted_group = group.sort_values('ds')",
                "2. å‰å›å‹¤å‹™çµ‚äº†ã€œæ¬¡å›å‹¤å‹™é–‹å§‹ã®æ™‚é–“å·®ã‚’è¨ˆç®—",
                "3. interval_hours < 11æ™‚é–“ã§é•åæ¤œçŸ¥",
                "4. violation_rate = violations / total_intervals"
            ],
            "æ³•çš„åŸºæº–": "11æ™‚é–“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ç¢ºä¿ï¼ˆåŠªåŠ›ç¾©å‹™ï¼‰",
            "é‡è¦åº¦åˆ¤å®š": "é«˜ï¼ˆ30%è¶…ã®é•åç‡ï¼‰ã€ä¸­ï¼ˆ10%è¶…ã®é•åç‡ï¼‰",
            "å‡ºåŠ›ä¾‹": "å‹¤å‹™é–“ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«é•åãŒå¤šç™º (15/50å›)"
        }
    }
    
    for law_section, details in labor_law_calculations.items():
        print(f"\nğŸ“œ {law_section}")
        print(f"  ğŸ’» é›†è¨ˆå‡¦ç†: {details['é›†è¨ˆé …ç›®']}")
        print("  ğŸ”§ å…·ä½“çš„å‡¦ç†:")
        for step in details['å…·ä½“çš„å‡¦ç†']:
            print(f"    {step}")
        print(f"  âš–ï¸ æ³•çš„åŸºæº–: {details['æ³•çš„åŸºæº–']}")
        print(f"  ğŸš¨ é‡è¦åº¦: {details['é‡è¦åº¦åˆ¤å®š']}")
        print(f"  ğŸ“ å‡ºåŠ›ä¾‹: {details['å‡ºåŠ›ä¾‹']}")
    
    # 2. åŒ»ç™‚æ³•ãƒ»çœ‹è­·æ¥­ç•Œæº–æ‹ ã®é›†è¨ˆ
    print(f"\nğŸ¥ åŒ»ç™‚æ³•ãƒ»çœ‹è­·æ¥­ç•Œæ¨™æº–æº–æ‹ é›†è¨ˆ")
    print("-" * 90)
    
    medical_law_calculations = {
        "åŒ»ç™‚æ³•æ–½è¡Œè¦å‰‡ç¬¬19æ¡ã®3ï¼ˆçœ‹è­·è·å“¡é…ç½®ï¼‰": {
            "é›†è¨ˆé …ç›®": "role_stats = work_df.groupby('role').agg({'staff': 'nunique', 'parsed_slots_count': 'sum'})",
            "å…·ä½“çš„å‡¦ç†": [
                "1. è·ç¨®åˆ¥ã®è·å“¡æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆï¼ˆ'role'åˆ—ã«ã‚ˆã‚‹åˆ†é¡ï¼‰",
                "2. è·ç¨®åˆ¥ã®ç·åŠ´åƒæ™‚é–“ã‚’é›†è¨ˆ",
                "3. ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãƒ»ç·ã‚¹ãƒ­ãƒƒãƒˆæ•°ã‚’è·ç¨®åˆ¥ã«ç®—å‡º",
                "4. è·ç¨®åˆ¥åŠ´åƒæ™‚é–“ = ã‚¹ãƒ­ãƒƒãƒˆæ•° Ã— 0.5æ™‚é–“"
            ],
            "æ³•çš„åŸºæº–": "çœ‹è­·è·å“¡ã®é©æ­£é…ç½®ï¼ˆæ‚£è€…7:1ã€10:1ç­‰ï¼‰",
            "ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤": "åŒ»ç™‚ã®è³ªç¢ºä¿ã€è¨ºç™‚å ±é…¬é©æ­£è«‹æ±‚",
            "å‡ºåŠ›ä¾‹": "çœ‹è­·å¸«: 25åã€ç·åŠ´åƒæ™‚é–“: 4,200æ™‚é–“ã€ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: 8,400ä»¶"
        },
        
        "çœ‹è­·è·å“¡ã®å¤œå‹¤ãƒ»äº¤ä»£åˆ¶å‹¤å‹™ã«é–¢ã™ã‚‹æŒ‡é‡": {
            "é›†è¨ˆé …ç›®": "night_shifts = group[group['code'].str.contains('å¤œ', na=False)].shape[0]",
            "å…·ä½“çš„å‡¦ç†": [
                "1. ã‚³ãƒ¼ãƒ‰åˆ—ã«'å¤œ'ã‚’å«ã‚€å‹¤å‹™ã‚’ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã§æ¤œå‡º",
                "2. night_shift_ratio = night_shifts / total_shifts",
                "3. å¤œå‹¤æ¯”ç‡ > 40%ã§ç•°å¸¸ã¨ã—ã¦æ¤œçŸ¥",
                "4. å€‹äººåˆ¥ã®å¤œå‹¤è² è·ã‚’å®šé‡åŒ–"
            ],
            "æ³•çš„åŸºæº–": "æœˆ8å›ä»¥å†…ã®å¤œå‹¤ã€é©åˆ‡ãªå¤œå‹¤é–“éš”ç¢ºä¿",
            "é‡è¦åº¦åˆ¤å®š": "é«˜ï¼ˆ60%è¶…ï¼‰ã€ä¸­ï¼ˆ40%è¶…ï¼‰ã€ä½ï¼ˆ30%è¶…ï¼‰",
            "å‡ºåŠ›ä¾‹": "å¤œå‹¤é »åº¦ãŒéå¤š (45.2%ã€28å›/62å›)"
        },
        
        "é›‡ç”¨å½¢æ…‹åˆ¥ç®¡ç†ï¼ˆåŠ´åƒå¥‘ç´„æ³•ï¼‰": {
            "é›†è¨ˆé …ç›®": "emp_stats = work_df.groupby('employment').agg({'staff': 'nunique', 'parsed_slots_count': 'sum'})",
            "å…·ä½“çš„å‡¦ç†": [
                "1. é›‡ç”¨å½¢æ…‹åˆ¥ï¼ˆæ­£è·å“¡ãƒ»ãƒ‘ãƒ¼ãƒˆãƒ»æ´¾é£ç­‰ï¼‰ã®é›†è¨ˆ",
                "2. é›‡ç”¨å½¢æ…‹åˆ¥ã®è·å“¡æ•°ãƒ»åŠ´åƒæ™‚é–“ã‚’ç®—å‡º",
                "3. é›‡ç”¨å½¢æ…‹åˆ¥ã®åŠ´åƒè² è·ãƒãƒ©ãƒ³ã‚¹åˆ†æ",
                "4. éæ­£è¦è·å“¡ã®åŠ´åƒæ™‚é–“ä¸Šé™ç®¡ç†"
            ],
            "æ³•çš„åŸºæº–": "æœ‰æœŸå¥‘ç´„åŠ´åƒè€…ã®é©æ­£ç®¡ç†ã€åŒä¸€åŠ´åƒåŒä¸€è³ƒé‡‘",
            "ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤": "äººä»¶è²»æœ€é©åŒ–ã€ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ç¢ºä¿",
            "å‡ºåŠ›ä¾‹": "æ­£è·å“¡: 30åã€ãƒ‘ãƒ¼ãƒˆ: 15åã€æ´¾é£: 5å"
        }
    }
    
    for regulation, details in medical_law_calculations.items():
        print(f"\nğŸ¥ {regulation}")
        print(f"  ğŸ’» é›†è¨ˆå‡¦ç†: {details['é›†è¨ˆé …ç›®']}")
        print("  ğŸ”§ å…·ä½“çš„å‡¦ç†:")
        for step in details['å…·ä½“çš„å‡¦ç†']:
            print(f"    {step}")
        print(f"  âš–ï¸ æ³•çš„åŸºæº–: {details['æ³•çš„åŸºæº–']}")
        if 'ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤' in details:
            print(f"  ğŸ’° ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤: {details['ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤']}")
        if 'é‡è¦åº¦åˆ¤å®š' in details:
            print(f"  ğŸš¨ é‡è¦åº¦: {details['é‡è¦åº¦åˆ¤å®š']}")
        print(f"  ğŸ“ å‡ºåŠ›ä¾‹: {details['å‡ºåŠ›ä¾‹']}")

def analyze_time_pattern_compliance():
    """æ™‚é–“ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æã®æ³•çš„æº–æ‹ """
    
    print(f"\nâ° æ™‚é–“ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æã®æ³•çš„æº–æ‹ ")
    print("=" * 100)
    
    time_pattern_calculations = {
        "æ›œæ—¥åˆ¥å‹¤å‹™åˆ†æ": {
            "é›†è¨ˆå‡¦ç†": "weekday_counts = group.groupby(group['ds'].dt.dayofweek).size()",
            "æ³•çš„æ ¹æ‹ ": "åŠ´åƒåŸºæº–æ³•ç¬¬35æ¡ï¼ˆé€±ä¼‘åˆ¶ï¼‰",
            "å…·ä½“çš„è¨ˆç®—": [
                "1. æ›œæ—¥ç•ªå·å–å¾—: ds.dt.dayofweek (0=æœˆæ›œ, 6=æ—¥æ›œ)",
                "2. æ›œæ—¥åˆ¥å‹¤å‹™å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ",
                "3. å„æ›œæ—¥ã®å‹¤å‹™æ¯”ç‡ã‚’è¨ˆç®—: count / total_records",
                "4. åœŸæ—¥å‹¤å‹™ç‡ã®ç‰¹åˆ¥é›†è¨ˆ: weekend_shifts = group[ds.dt.dayofweek.isin([5,6])]"
            ],
            "æº–æ‹ ç¢ºèª": "é€±1å›ä¼‘æ—¥ç¢ºä¿ã€åœŸæ—¥å‹¤å‹™éå¤šã®æ¤œçŸ¥",
            "å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿": "æœˆæ›œ: 15å›(24%), ç«æ›œ: 12å›(19%), ..., æ—¥æ›œ: 3å›(5%)"
        },
        
        "æ™‚é–“å¸¯åˆ¥å‹¤å‹™åˆ†æ": {
            "é›†è¨ˆå‡¦ç†": "hour_counts = group.groupby(group['ds'].dt.hour).size()",
            "æ³•çš„æ ¹æ‹ ": "åŠ´åƒåŸºæº–æ³•ç¬¬37æ¡ï¼ˆæ·±å¤œåŠ´åƒï¼‰ã€åŠ´åƒå®‰å…¨è¡›ç”Ÿæ³•",
            "å…·ä½“çš„è¨ˆç®—": [
                "1. æ™‚é–“å–å¾—: ds.dt.hour (0-23æ™‚)",
                "2. æ™‚é–“å¸¯åˆ¥å‹¤å‹™å›æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ",
                "3. æ·±å¤œæ™‚é–“å¸¯ï¼ˆ22-6æ™‚ï¼‰ã®ç‰¹åˆ¥é›†è¨ˆ",
                "4. æ™‚é–“å¸¯åˆ¥å‹¤å‹™æ¯”ç‡: count / total_records"
            ],
            "æº–æ‹ ç¢ºèª": "æ·±å¤œåŠ´åƒï¼ˆ22-6æ™‚ï¼‰ã®é©æ­£ç®¡ç†ã€åŠ´åƒå¼·åº¦åˆ†æ",
            "å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿": "8æ™‚å°: 25å›(15%), 22æ™‚å°: 8å›(5%), 2æ™‚å°: 12å›(7%)"
        },
        
        "ä¼‘æ—¥å‹¤å‹™åˆ†æ": {
            "é›†è¨ˆå‡¦ç†": "holiday_shifts = group[group['holiday_type'].notna() & (group['holiday_type'] != '')]",
            "æ³•çš„æ ¹æ‹ ": "åŠ´åƒåŸºæº–æ³•ç¬¬35æ¡ï¼ˆä¼‘æ—¥åŠ´åƒï¼‰",
            "å…·ä½“çš„è¨ˆç®—": [
                "1. holiday_typeåˆ—ã®éç©ºãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º",
                "2. ä¼‘æ—¥ç¨®åˆ¥ï¼ˆç¥æ—¥ãƒ»å¹´æœ«å¹´å§‹ç­‰ï¼‰åˆ¥ã®é›†è¨ˆ",
                "3. ä¼‘æ—¥å‹¤å‹™å›æ•°ãƒ»æ¯”ç‡ã®ç®—å‡º",
                "4. ä¼‘æ—¥åŠ´åƒæ‰‹å½“å¯¾è±¡ã®å‹¤å‹™ç‰¹å®š"
            ],
            "æº–æ‹ ç¢ºèª": "ä¼‘æ—¥åŠ´åƒã®é©æ­£ç®¡ç†ã€å‰²å¢—è³ƒé‡‘è¨ˆç®—æ ¹æ‹ ",
            "å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿": "ç¥æ—¥å‹¤å‹™: 5å›, å¹´æœ«å¹´å§‹: 2å›, å…¨ä¼‘æ—¥å‹¤å‹™ç‡: 12%"
        }
    }
    
    for pattern_type, details in time_pattern_calculations.items():
        print(f"\nğŸ“Š {pattern_type}")
        print(f"  ğŸ’» é›†è¨ˆå‡¦ç†: {details['é›†è¨ˆå‡¦ç†']}")
        print(f"  âš–ï¸ æ³•çš„æ ¹æ‹ : {details['æ³•çš„æ ¹æ‹ ']}")
        print("  ğŸ”§ å…·ä½“çš„è¨ˆç®—:")
        for step in details['å…·ä½“çš„è¨ˆç®—']:
            print(f"    {step}")
        print(f"  âœ… æº–æ‹ ç¢ºèª: {details['æº–æ‹ ç¢ºèª']}")
        print(f"  ğŸ“‹ å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿: {details['å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿']}")

def demonstrate_calculation_examples():
    """å®Ÿéš›ã®è¨ˆç®—ä¾‹ã®è©³ç´°ãƒ‡ãƒ¢"""
    
    print(f"\nğŸ’¡ å®Ÿéš›ã®è¨ˆç®—ä¾‹ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³")
    print("=" * 100)
    
    # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ã®è¨ˆç®—ä¾‹
    calculation_examples = {
        "åŠ´åƒæ™‚é–“é•åæ¤œçŸ¥ã®è¨ˆç®—ä¾‹": {
            "ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿": "ç”°ä¸­å¤ªéƒã•ã‚“: 7æœˆ = 285æ™‚é–“, å…¨ä½“å¹³å‡ = 180æ™‚é–“",
            "è¨ˆç®—éç¨‹": [
                "1. threshold = 180 * 1.5 = 270æ™‚é–“",
                "2. 285 > 270 â†’ é•åæ¤œçŸ¥",
                "3. severity = calculate_severity(285, 270, 360)",
                "4. 285 > 270*1.5(405) â†’ False, 285 > 270*1.2(324) â†’ False â†’ 'ä¸­'"
            ],
            "å‡ºåŠ›çµæœ": "AnomalyResult(anomaly_type='éåº¦ãªåŠ´åƒæ™‚é–“', severity='ä¸­', staff='ç”°ä¸­å¤ªéƒ', value=285.0)",
            "æ³•çš„æ„å‘³": "æœˆé–“åŠ´åƒæ™‚é–“ãŒåŸºæº–å€¤ã‚’55%è¶…éã€è¦æ³¨æ„ãƒ¬ãƒ™ãƒ«"
        },
        
        "é€£ç¶šå‹¤å‹™é•åã®è¨ˆç®—ä¾‹": {
            "ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿": "ä½è—¤èŠ±å­ã•ã‚“: 7/1,7/2,7/3,7/4,7/5,7/6,7/7,7/8,7/9",
            "è¨ˆç®—éç¨‹": [
                "1. work_dates = [2024-07-01, 2024-07-02, ..., 2024-07-09]",
                "2. continuous_days = 9 (é€£ç¶š9æ—¥é–“)",
                "3. 9 > threshold(7) â†’ é•åæ¤œçŸ¥",
                "4. severity = calculate_severity(9, 7, 12) â†’ 'é«˜'"
            ],
            "å‡ºåŠ›çµæœ": "AnomalyResult(anomaly_type='é€£ç¶šå‹¤å‹™é•å', severity='é«˜', staff='ä½è—¤èŠ±å­', value=9)",
            "æ³•çš„æ„å‘³": "åŠ´åƒåŸºæº–æ³•ç¬¬35æ¡é•åã®å¯èƒ½æ€§ã€ç·Šæ€¥å¯¾å¿œå¿…è¦"
        },
        
        "å¤œå‹¤é »åº¦éå¤šã®è¨ˆç®—ä¾‹": {
            "ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿": "å±±ç”°æ¬¡éƒã•ã‚“: å…¨62å›å‹¤å‹™ä¸­ã€å¤œå‹¤28å›",
            "è¨ˆç®—éç¨‹": [
                "1. night_shifts = 28 (codeåˆ—ã«'å¤œ'ã‚’å«ã‚€å‹¤å‹™)",
                "2. night_shift_ratio = 28/62 = 0.452 (45.2%)",
                "3. 0.452 > threshold(0.4) â†’ é•åæ¤œçŸ¥",
                "4. severity = calculate_severity(0.452, 0.4, 0.6) â†’ 'ä¸­'"
            ],
            "å‡ºåŠ›çµæœ": "AnomalyResult(anomaly_type='å¤œå‹¤é »åº¦éå¤š', severity='ä¸­', staff='å±±ç”°æ¬¡éƒ', value=0.452)",
            "æ³•çš„æ„å‘³": "çœ‹è­·è·å“¡å¤œå‹¤æŒ‡é‡åŸºæº–è¶…éã€å¥åº·ç®¡ç†è¦æ³¨æ„"
        },
        
        "è·ç¨®åˆ¥åŠ´åƒæ™‚é–“é›†è¨ˆä¾‹": {
            "ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿": "çœ‹è­·å¸«25åã€ä»‹è­·å£«15åã€äº‹å‹™å“¡5å",
            "è¨ˆç®—éç¨‹": [
                "1. role_stats = work_df.groupby('role').agg({'staff': 'nunique', 'parsed_slots_count': 'sum'})",
                "2. çœ‹è­·å¸«: staff=25, slots=8400, hours=4200.0",
                "3. ä»‹è­·å£«: staff=15, slots=4800, hours=2400.0", 
                "4. äº‹å‹™å“¡: staff=5, slots=800, hours=400.0"
            ],
            "å‡ºåŠ›çµæœ": "è·ç¨®åˆ¥çµ±è¨ˆDataFrame: çœ‹è­·å¸«(25å,4200h), ä»‹è­·å£«(15å,2400h), äº‹å‹™å“¡(5å,400h)",
            "æ³•çš„æ„å‘³": "åŒ»ç™‚æ³•çœ‹è­·è·å“¡é…ç½®åŸºæº–ã®éµå®ˆçŠ¶æ³ç¢ºèªãƒ‡ãƒ¼ã‚¿"
        }
    }
    
    for example_name, details in calculation_examples.items():
        print(f"\nğŸ§® {example_name}")
        print(f"  ğŸ“Š ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿: {details['ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿']}")
        print("  ğŸ”¢ è¨ˆç®—éç¨‹:")
        for step in details['è¨ˆç®—éç¨‹']:
            print(f"    {step}")
        print(f"  ğŸ“‹ å‡ºåŠ›çµæœ: {details['å‡ºåŠ›çµæœ']}")
        print(f"  âš–ï¸ æ³•çš„æ„å‘³: {details['æ³•çš„æ„å‘³']}")

if __name__ == "__main__":
    print("ğŸ” æ³•çš„ãƒ»æ¥­ç•Œæ¨™æº–æº–æ‹ ã®å…·ä½“çš„é›†è¨ˆå†…å®¹ã‚’è©³ç´°åˆ†æã—ã¾ã™...")
    
    analyze_legal_compliance_calculations()
    analyze_time_pattern_compliance()
    demonstrate_calculation_examples()
    
    print(f"\n" + "=" * 100)
    print("ğŸ“‹ çµè«–: å…¨é›†è¨ˆé …ç›®ãŒå…·ä½“çš„ãªæ³•ä»¤æ¡æ–‡ã¨æ¥­ç•Œæ¨™æº–ã«ç›´æ¥å¯¾å¿œ")
    print("âš–ï¸ æ ¹æ‹ : åŠ´åƒåŸºæº–æ³•ãƒ»åŒ»ç™‚æ³•ãƒ»çœ‹è­·æ¥­ç•ŒæŒ‡é‡ã®æ¡æ–‡ãƒ¬ãƒ™ãƒ«æº–æ‹ ")
    print("ğŸ¯ ç²¾åº¦: å€‹äººãƒ»æœŸé–“ãƒ»è·ç¨®ãƒ»æ™‚é–“è»¸ã§ã®å¤šæ¬¡å…ƒçš„æ³•ä»¤éµå®ˆãƒã‚§ãƒƒã‚¯")
    print("âœ… åˆ†æå®Œäº†")